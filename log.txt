go generate ./hardcoded/
go generate ./server/gendb/
go build -o bin/wag
hash npm 2>/dev/null || (echo "Could not run npm, please install node" && false)
hash jsdoc2md 2>/dev/null || npm install -g jsdoc-to-markdown@^4.0.0
/Library/Developer/CommandLineTools/usr/bin/make -C samples generate
github.com/Clever/wag/samples/v9/test ./gen-go-db/server/db/dynamodb
../bin/wag -with-tests -file ./swagger.yml -output-path ./gen-go-basic -js-path ./gen-js
cd ./gen-js && jsdoc2md index.js types.js > ./README.md    
cd ./gen-go-basic/client && go mod tidy
cd ./gen-go-basic/models && go mod tidy
go generate -mod=mod ./gen-go-basic...
../bin/wag -with-tests -file ./deprecated.yml -output-path ./gen-go-deprecated -js-path ./gen-js-deprecated
cd ./gen-js-deprecated && jsdoc2md index.js types.js > ./README.md
cd ./gen-go-deprecated/client && go mod tidy
cd ./gen-go-deprecated/models && go mod tidy
go generate -mod=mod ./gen-go-deprecated...
../bin/wag -with-tests -file ./errors.yml -output-path ./gen-go-errors -js-path ./gen-js-errors
cd ./gen-js-errors && jsdoc2md index.js types.js > ./README.md
cd ./gen-go-errors/client && go mod tidy
cd ./gen-go-errors/models && go mod tidy
go generate -mod=mod ./gen-go-errors...
../bin/wag -with-tests -file ./nils.yml -output-path ./gen-go-nils -js-path ./gen-js-nils
cd ./gen-js-nils && jsdoc2md index.js types.js > ./README.md
cd ./gen-go-nils/client && go mod tidy
cd ./gen-go-nils/models && go mod tidy
go generate -mod=mod ./gen-go-nils...
../bin/wag -with-tests -file ./strings.yml -output-path ./gen-go-strings -js-path ./gen-js-strings
cd ./gen-js-strings && jsdoc2md index.js types.js > ./README.md
cd ./gen-go-strings/client && go mod tidy
cd ./gen-go-strings/models && go mod tidy
go generate -mod=mod ./gen-go-strings...
../bin/wag -with-tests -file ./blog.yml -output-path ./gen-go-blog -js-path ./gen-js-blog
cd ./gen-js-blog && jsdoc2md index.js types.js > ./README.md
cd ./gen-go-blog/client && go mod tidy
cd ./gen-go-blog/models && go mod tidy
go generate -mod=mod ./gen-go-nils...
../bin/wag -with-tests -file ./db.yml -output-path ./gen-go-db -js-path ./gen-js-db
cd ./gen-js-db && jsdoc2md index.js types.js > ./README.md
cd ./gen-go-db/client && go mod tidy
cd ./gen-go-db/models && go mod tidy
go generate -mod=mod ./gen-go-db...
../bin/wag -with-tests -file ./swagger.yml -output-path ./gen-go-client-only -js-path ./gen-js-client-only --client-only
cd ./gen-js-client-only && jsdoc2md index.js types.js > ./README.md
cd ./gen-go-client-only/client && go mod tidy
cd ./gen-go-client-only/models && go mod tidy
go generate -mod=mod ./gen-go-client-only...
../bin/wag -with-tests -file ./db.yml -output-path ./gen-go-db-only -dynamo-only
cd ./gen-go-db-only/models && go mod tidy
cd ./gen-go-db-only/ go mod tidy
go generate -mod=mod ./gen-go-db-only...
../bin/wag -with-tests -file ./db.yml -output-path ./gen-go-db-custom-path -js-path ./gen-js-db-custom-path -dynamo-path db
cd ./gen-js-db-custom-path && jsdoc2md index.js types.js > ./README.md
cd ./gen-go-db-custom-path/client && go mod tidy
cd ./gen-go-db-custom-path/models && go mod tidy
cd ./gen-go-db-custom-path/ go mod tidy
go generate -mod=mod ./gen-go-db-custom-path...
go install -mod=mod golang.org/x/tools/cmd/goimports@v0.24.0
goimports -w .
FORMATTING github.com/Clever/wag/v9...
LINTING github.com/Clever/wag/v9...
VETTING github.com/Clever/wag/v9...
TESTING github.com/Clever/wag/v9...
=== RUN   Test_config_validate
=== RUN   Test_config_validate/with_server
=== RUN   Test_config_validate/client_only
=== RUN   Test_config_validate/client_only_go
=== RUN   Test_config_validate/client_only_js
=== RUN   Test_config_validate/server_with_js_client
=== RUN   Test_config_validate/server_with_go_client
=== RUN   Test_config_validate/js_client_no_jsModulePath
=== RUN   Test_config_validate/client_only_invalid_language
=== RUN   Test_config_validate/dynamo_only_custom_path
=== RUN   Test_config_validate/dynamo_only_default_path
--- PASS: Test_config_validate (0.00s)
    --- PASS: Test_config_validate/with_server (0.00s)
    --- PASS: Test_config_validate/client_only (0.00s)
    --- PASS: Test_config_validate/client_only_go (0.00s)
    --- PASS: Test_config_validate/client_only_js (0.00s)
    --- PASS: Test_config_validate/server_with_js_client (0.00s)
    --- PASS: Test_config_validate/server_with_go_client (0.00s)
    --- PASS: Test_config_validate/js_client_no_jsModulePath (0.00s)
    --- PASS: Test_config_validate/client_only_invalid_language (0.00s)
    --- PASS: Test_config_validate/dynamo_only_custom_path (0.00s)
    --- PASS: Test_config_validate/dynamo_only_default_path (0.00s)
PASS
ok  	github.com/Clever/wag/v9	(cached)
FORMATTING github.com/Clever/wag/v9/clients/go...
LINTING github.com/Clever/wag/v9/clients/go...
VETTING github.com/Clever/wag/v9/clients/go...
TESTING github.com/Clever/wag/v9/clients/go...
?   	github.com/Clever/wag/v9/clients/go	[no test files]
FORMATTING github.com/Clever/wag/v9/clients/js...
LINTING github.com/Clever/wag/v9/clients/js...
VETTING github.com/Clever/wag/v9/clients/js...
TESTING github.com/Clever/wag/v9/clients/js...
=== RUN   TestFillOutPath
--- PASS: TestFillOutPath (0.00s)
=== RUN   TestGenerateErrorDeclaration
=== RUN   TestGenerateErrorDeclaration/It_generates_a_type_declaration
=== RUN   TestGenerateErrorDeclaration/Given_some_additional_properties
=== RUN   TestGenerateErrorDeclaration/Given_some_additional_properties/When_some_of_the_properties_are_required
--- PASS: TestGenerateErrorDeclaration (0.00s)
    --- PASS: TestGenerateErrorDeclaration/It_generates_a_type_declaration (0.00s)
    --- PASS: TestGenerateErrorDeclaration/Given_some_additional_properties (0.00s)
        --- PASS: TestGenerateErrorDeclaration/Given_some_additional_properties/When_some_of_the_properties_are_required (0.00s)
=== RUN   TestGeneratePropertyDeclaration
=== RUN   TestGeneratePropertyDeclaration/key_has_no_special_chars_and_is_not_required
=== RUN   TestGeneratePropertyDeclaration/key_has_no_special_chars_and_is_required
=== RUN   TestGeneratePropertyDeclaration/key_has_a_dash_and_is_not_required
=== RUN   TestGeneratePropertyDeclaration/key_has_a_dash_and_is_required
=== RUN   TestGeneratePropertyDeclaration/key_has_an_emoji
--- PASS: TestGeneratePropertyDeclaration (0.00s)
    --- PASS: TestGeneratePropertyDeclaration/key_has_no_special_chars_and_is_not_required (0.00s)
    --- PASS: TestGeneratePropertyDeclaration/key_has_no_special_chars_and_is_required (0.00s)
    --- PASS: TestGeneratePropertyDeclaration/key_has_a_dash_and_is_not_required (0.00s)
    --- PASS: TestGeneratePropertyDeclaration/key_has_a_dash_and_is_required (0.00s)
    --- PASS: TestGeneratePropertyDeclaration/key_has_an_emoji (0.00s)
=== RUN   TestMethodDeclWithHyphens
--- PASS: TestMethodDeclWithHyphens (0.00s)
PASS
ok  	github.com/Clever/wag/v9/clients/js	(cached)
FORMATTING github.com/Clever/wag/v9/models...
LINTING github.com/Clever/wag/v9/models...
VETTING github.com/Clever/wag/v9/models...
TESTING github.com/Clever/wag/v9/models...
?   	github.com/Clever/wag/v9/models	[no test files]
FORMATTING github.com/Clever/wag/v9/server...
LINTING github.com/Clever/wag/v9/server...
VETTING github.com/Clever/wag/v9/server...
TESTING github.com/Clever/wag/v9/server...
?   	github.com/Clever/wag/v9/server	[no test files]
FORMATTING github.com/Clever/wag/v9/swagger...
LINTING github.com/Clever/wag/v9/swagger...
VETTING github.com/Clever/wag/v9/swagger...
TESTING github.com/Clever/wag/v9/swagger...
=== RUN   TestBadReference
--- PASS: TestBadReference (0.03s)
=== RUN   TestReferenceMissingMessageField
--- PASS: TestReferenceMissingMessageField (0.03s)
=== RUN   TestErrorOnMissingTypes
--- PASS: TestErrorOnMissingTypes (0.02s)
=== RUN   TestOtherRequiredField
--- PASS: TestOtherRequiredField (0.02s)
=== RUN   Test3xxError
--- PASS: Test3xxError (0.03s)
=== RUN   TestMultiSuccessError
--- PASS: TestMultiSuccessError (0.03s)
=== RUN   TestAddingDefaultTypes
--- PASS: TestAddingDefaultTypes (0.03s)
=== RUN   TestOverrideDefaults
--- PASS: TestOverrideDefaults (0.03s)
PASS
ok  	github.com/Clever/wag/v9/swagger	(cached)
FORMATTING github.com/Clever/wag/v9/templates...
LINTING github.com/Clever/wag/v9/templates...
VETTING github.com/Clever/wag/v9/templates...
TESTING github.com/Clever/wag/v9/templates...
?   	github.com/Clever/wag/v9/templates	[no test files]
FORMATTING github.com/Clever/wag/v9/utils...
LINTING github.com/Clever/wag/v9/utils...
VETTING github.com/Clever/wag/v9/utils...
TESTING github.com/Clever/wag/v9/utils...
?   	github.com/Clever/wag/v9/utils	[no test files]
FORMATTING github.com/Clever/wag/v9/validation...
LINTING github.com/Clever/wag/v9/validation...
VETTING github.com/Clever/wag/v9/validation...
TESTING github.com/Clever/wag/v9/validation...
=== RUN   TestValidateOpID
--- PASS: TestValidateOpID (0.00s)
=== RUN   TestValidatePathParams
--- PASS: TestValidatePathParams (0.00s)
=== RUN   TestValidateRawRef
--- PASS: TestValidateRawRef (0.00s)
=== RUN   TestNestedTypes
--- PASS: TestNestedTypes (0.00s)
PASS
ok  	github.com/Clever/wag/v9/validation	(cached)
cd samples/gen-js && rm -rf node_modules && npm install

added 91 packages, and audited 92 packages in 4s

13 packages are looking for funding
  run `npm fund` for details

2 moderate severity vulnerabilities

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
cd samples/test/js && rm -rf node_modules && npm install && npm test

added 144 packages, and audited 146 packages in 1s

23 packages are looking for funding
  run `npm fund` for details

12 vulnerabilities (3 low, 5 high, 4 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.

> wag-test-js@0.1.0 test
> mocha --require ts-node/register *.{ts,js}



  circuit
    ✓ opens when the number of failures exceeds requestVolumeThreshold, and closes if sees success after sleep window (852ms)
    ✓ doesn't do anything if forceClosed is set to true (59ms)
    ✓ logs state of the circuit (1528ms)
    ✓ 4xxs are counted as warnings (1556ms)
    ✓ applies callback, if provided, to circuit-breaker error

  paging
    ✓ iterators support map
    ✓ iterators support forEach
    ✓ iterators forEach does not support async callback
    ✓ iterators support forEachAsync (308ms)
    ✓ iterators support resource path
    ✓ iterators pass through errors (1009ms)
    ✓ iterators handle callbacks

  initialization
    ✓ fails if not given address or discovery
    ✓ succeeds given `address`
    given `discovery`
      ✓ fails with no env vars
      ✓ succeeds with default expose
      ✓ succeeds with legacy `http` expose
      ✓ uses serviceName when one is passed in

  operations
    ✓ properly combines store and options baggage
    ✓ properly sets baggage headers
    ✓ correctly fill out path, header and query params
    ✓ works with multiple clients as long as a different serviceName is used
    ✓ error on empty path param
    ✓ return a error in failure cases
    ✓ return a promise
    ✓ return a error to the promise
    ✓ sends a version header

  retries
    ✓ performs exponential retries when set backoff by default (304ms)
    ✓ lets the user configure a custom retry policy on the client
    ✓ lets the user configure a custom retry policy on a single request
    ✓ does not retry POSTs
    ✓ does not retry network errors


  32 passing (6s)

/Library/Developer/CommandLineTools/usr/bin/make -C samples test
go mod tidy
go mod vendor
